<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Unlock Feature - Vadrifts</title>
    <link rel="icon" href="https://i.imgur.com/ePueN25.png" type="image/png">
    <script defer src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gradient-primary: linear-gradient(90deg, #ffffff 0%, #7209b7 100%);
            --gradient-button: linear-gradient(135deg, #7209b7 0%, #9c88ff 100%);
            --accent-color: #7209b7;
            --accent-glow: rgba(114, 9, 183, 0.5);
        }

        body {
            background: #000;
            color: #fff;
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-lights {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .light {
            position: absolute;
            border-radius: 50%;
            filter: blur(150px);
            opacity: 0.35;
            animation: float 15s ease-in-out infinite;
            transition: background 0.5s ease;
        }

        .light-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, #7209b7 0%, transparent 70%);
            top: -150px;
            left: -150px;
        }

        .light-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, #9c88ff 0%, transparent 70%);
            bottom: -150px;
            right: -150px;
            animation-delay: -7s;
        }

        .light-1.success {
            background: radial-gradient(circle, #10b981 0%, transparent 70%);
        }

        .light-2.success {
            background: radial-gradient(circle, #34d399 0%, transparent 70%);
        }

        .light-1.error {
            background: radial-gradient(circle, #ef4444 0%, transparent 70%);
        }

        .light-2.error {
            background: radial-gradient(circle, #f87171 0%, transparent 70%);
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(30px, -30px) scale(1.1); }
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #a855f7;
            border-radius: 50%;
            opacity: 0.6;
            animation: floatUp 20s linear infinite;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) translateX(0); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.4; }
            100% { transform: translateY(-50px) translateX(50px); opacity: 0; }
        }

        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 3;
            pointer-events: none;
            display: none;
        }

        .confetti.show {
            display: block;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            top: -20px;
            animation: confettiFall 4s ease-out forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .navbar {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 20px;
            padding: 24px 32px;
            max-width: 1000px;
            width: 90%;
        }

        .nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: 700;
            background: var(--gradient-primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }

        .nav-logo-img {
            width: 28px;
            height: 28px;
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-link {
            color: #ccc;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            padding: 8px 12px;
        }

        .nav-link:hover {
            color: #fff;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 140px 20px 40px;
            position: relative;
            z-index: 10;
        }

        .main-box {
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 24px;
            padding: 50px 40px;
            animation: fadeIn 0.8s ease;
            transition: border-color 0.3s ease;
        }

        .main-box.success {
            border-color: rgba(16, 185, 129, 0.3);
        }

        .main-box.error {
            border-color: rgba(239, 68, 68, 0.3);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .state {
            display: none;
        }

        .state.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .header {
            text-align: center;
            margin-bottom: 35px;
        }

        .icon-wrapper {
            width: 80px;
            height: 80px;
            margin: 0 auto 25px;
            background: linear-gradient(135deg, #7209b7, #9c88ff);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            box-shadow: 0 15px 40px rgba(114, 9, 183, 0.4);
            transition: all 0.3s ease;
        }

        .icon-wrapper.success {
            background: linear-gradient(135deg, #059669, #10b981);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
            animation: iconPop 0.6s ease;
        }

        .icon-wrapper.error {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            box-shadow: 0 15px 40px rgba(239, 68, 68, 0.4);
            animation: shake 0.5s ease;
        }

        .icon-wrapper.success-pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes iconPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        h1 {
            font-size: 32px;
            font-weight: 800;
            background: var(--gradient-primary);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 12px;
        }

        h1.success {
            background: linear-gradient(135deg, #fff 0%, #10b981 100%);
            background-clip: text;
            -webkit-background-clip: text;
        }

        h1.error {
            background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
            background-clip: text;
            -webkit-background-clip: text;
        }

        .subtitle {
            color: #888;
            font-size: 15px;
            line-height: 1.6;
        }

        .subtitle strong {
            color: #9c88ff;
        }

        .subtitle.success strong {
            color: #10b981;
        }

        .vpn-warning {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.12) 0%, rgba(251, 191, 36, 0.06) 100%);
            border: 1px solid rgba(251, 191, 36, 0.25);
            border-radius: 14px;
            padding: 18px 22px;
            margin-bottom: 25px;
            display: flex;
            align-items: flex-start;
            gap: 14px;
        }

        .vpn-warning-icon {
            font-size: 22px;
            flex-shrink: 0;
        }

        .vpn-warning-content {
            flex: 1;
        }

        .vpn-warning-title {
            color: #fbbf24;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }

        .vpn-warning-text {
            color: #d4a574;
            font-size: 13px;
            line-height: 1.6;
        }

        .vpn-warning-text strong {
            color: #fbbf24;
        }

        .instruction-box {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, rgba(16, 185, 129, 0.03) 100%);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 14px;
            padding: 22px;
            margin-bottom: 30px;
        }

        .instruction-title {
            color: #10b981;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instruction-title i {
            width: 18px;
            height: 18px;
        }

        .instruction-steps {
            color: #bbb;
            font-size: 14px;
            line-height: 1.9;
            list-style: none;
            counter-reset: step;
        }

        .instruction-steps li {
            counter-increment: step;
            position: relative;
            padding-left: 36px;
            margin-bottom: 8px;
        }

        .instruction-steps li:last-child {
            margin-bottom: 0;
        }

        .instruction-steps li::before {
            content: counter(step);
            position: absolute;
            left: 0;
            top: 1px;
            width: 22px;
            height: 22px;
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            color: #10b981;
        }

        .unlock-btn {
            width: 100%;
            padding: 18px 24px;
            background: linear-gradient(135deg, #7209b7 0%, #9c88ff 100%);
            border: none;
            border-radius: 14px;
            color: #fff;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 10px 30px rgba(114, 9, 183, 0.35);
            position: relative;
            overflow: hidden;
            margin-bottom: 25px;
        }

        .unlock-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .unlock-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(114, 9, 183, 0.5);
        }

        .unlock-btn:hover::before {
            left: 100%;
        }

        .unlock-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .unlock-btn:disabled:hover {
            transform: none;
            box-shadow: 0 10px 30px rgba(114, 9, 183, 0.35);
        }

        .unlock-btn:disabled:hover::before {
            left: -100%;
        }

        .unlock-btn i {
            width: 20px;
            height: 20px;
        }

        .info-badges {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .info-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.08);
            padding: 10px 16px;
            border-radius: 10px;
            font-size: 13px;
            color: #888;
            font-weight: 500;
        }

        .info-badge i {
            width: 16px;
            height: 16px;
        }

        .status-msg {
            padding: 14px 18px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 20px;
            display: none;
            align-items: center;
            gap: 10px;
        }

        .status-msg.show {
            display: flex;
        }

        .status-msg.loading {
            background: rgba(251, 191, 36, 0.12);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.25);
        }

        .status-msg.error {
            background: rgba(239, 68, 68, 0.12);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.25);
        }

        .loading-spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 50%;
            border-top-color: currentColor;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .credits-box {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.25);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .credits-number {
            font-size: 72px;
            font-weight: 900;
            background: linear-gradient(135deg, #10b981, #34d399);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            animation: numberPop 0.8s ease;
        }

        @keyframes numberPop {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .credits-label {
            color: #888;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 10px;
        }

        .success-info {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
            padding: 18px;
            color: #10b981;
            font-size: 14px;
            text-align: center;
        }

        .error-hint {
            margin-top: 25px;
            padding: 16px 20px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            color: #777;
            font-size: 13px;
            text-align: center;
        }

        .loading-state {
            text-align: center;
            padding: 40px 20px;
        }

        .loading-state .loading-spinner {
            width: 40px;
            height: 40px;
            border-width: 3px;
            margin: 0 auto 20px;
            border-color: rgba(114, 9, 183, 0.2);
            border-top-color: #9c88ff;
        }

        .loading-state p {
            color: #888;
        }

        @media (max-width: 768px) {
            .navbar {
                left: 10px;
                right: 10px;
                width: auto;
                transform: none;
                padding: 16px 18px;
            }

            .nav-links {
                gap: 15px;
            }

            .nav-link {
                font-size: 12px;
            }

            .container {
                padding: 120px 15px 30px;
            }

            .main-box {
                padding: 35px 25px;
            }

            h1 {
                font-size: 26px;
            }

            .credits-number {
                font-size: 56px;
            }

            .icon-wrapper {
                width: 70px;
                height: 70px;
                font-size: 35px;
            }

            .info-badges {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .nav-links {
                gap: 10px;
            }

            .nav-link {
                font-size: 11px;
                padding: 5px 8px;
            }

            .navbar {
                padding: 12px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-lights">
        <div class="light light-1" id="light1"></div>
        <div class="light light-2" id="light2"></div>
    </div>

    <div class="particles" id="particles"></div>
    <div class="confetti" id="confetti"></div>

    <nav class="navbar">
        <div class="nav-content">
            <a href="/" class="nav-logo">
                <img src="https://i.imgur.com/ePueN25.png" alt="Vadrifts" class="nav-logo-img">
                Vadrifts
            </a>
            <div class="nav-links">
                <a href="/scripts" class="nav-link">Scripts</a>
                <a href="/plugins" class="nav-link">Plugins</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="main-box" id="mainBox">

            <div class="state active" id="loadingState">
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <p>Loading...</p>
                </div>
            </div>

            <div class="state" id="unlockState">
                <div class="header">
                    <div class="icon-wrapper" id="featureIcon">üîì</div>
                    <h1 id="featureTitle">Unlock Feature</h1>
                    <p class="subtitle" id="featureDescription">Complete a quick verification to unlock this feature.</p>
                </div>

                <div class="vpn-warning">
                    <div class="vpn-warning-icon">‚ö†Ô∏è</div>
                    <div class="vpn-warning-content">
                        <div class="vpn-warning-title">Important: VPN/Proxy Notice</div>
                        <div class="vpn-warning-text">
                            Please <strong>disable any VPN or proxy</strong> before continuing and <strong>keep it off</strong> during the entire process.
                        </div>
                    </div>
                </div>

                <div class="instruction-box">
                    <div class="instruction-title">
                        <i data-lucide="list-ordered"></i>
                        <span>How to unlock:</span>
                    </div>
                    <ol class="instruction-steps">
                        <li>Click the unlock button below</li>
                        <li>Complete the quick task (~2 minutes)</li>
                        <li>Return to Roblox and use the feature</li>
                    </ol>
                </div>

                <div class="status-msg" id="statusMsg"></div>

                <button class="unlock-btn" id="unlockBtn" onclick="startUnlock()">
                    <i data-lucide="unlock"></i>
                    <span id="unlockBtnText">Unlock Feature</span>
                </button>

                <div class="info-badges">
                    <div class="info-badge">
                        <i data-lucide="clock"></i>
                        <span>Takes ~2 minutes</span>
                    </div>
                    <div class="info-badge">
                        <i data-lucide="zap"></i>
                        <span id="creditsPerUnlock">+2 credits per unlock</span>
                    </div>
                </div>
            </div>

            <div class="state" id="successState">
                <div class="header">
                    <div class="icon-wrapper success success-pulse" id="successIcon">üéâ</div>
                    <h1 class="success">Credits Unlocked!</h1>
                    <p class="subtitle success">You've earned <strong id="creditsEarnedText">+2 credits</strong>!</p>
                </div>

                <div class="credits-box">
                    <div class="credits-number" id="totalCredits">2</div>
                    <div class="credits-label">Total Credits</div>
                </div>

                <div class="success-info">
                    ‚úì Close this page and return to Roblox to use your credits!
                </div>
            </div>

            <div class="state" id="errorState">
                <div class="header">
                    <div class="icon-wrapper error">üö´</div>
                    <h1 class="error" id="errorTitle">Access Denied</h1>
                    <p class="subtitle" id="errorMessage">Please start the unlock process from the proper page first.</p>
                </div>

                <div class="error-hint">
                    Make sure you're following the correct verification flow from the Roblox script.
                </div>
            </div>

        </div>
    </div>

    <script>
        let featureConfig = null;
        let featureId = null;
        let pageMode = "{{PAGE_MODE}}";
        let successData = {
            icon: "{{SUCCESS_ICON}}",
            name: "{{SUCCESS_NAME}}",
            creditsAdded: "{{CREDITS_ADDED}}",
            totalCredits: "{{TOTAL_CREDITS}}"
        };
        let errorData = {
            title: "{{ERROR_TITLE}}",
            message: "{{ERROR_MESSAGE}}"
        };

        function getFeatureIdFromURL() {
            const path = window.location.pathname;
            const parts = path.split('/');
            return parts[parts.length - 1];
        }

        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = Math.random() * 100 + '%';
                p.style.animationDelay = -Math.random() * 20 + 's';
                p.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(p);
            }
        }

        function createConfetti() {
            const container = document.getElementById('confetti');
            container.classList.add('show');
            const colors = ['#10b981', '#34d399', '#6ee7b7', '#a7f3d0', '#fbbf24', '#9c88ff'];
            
            for (let i = 0; i < 50; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti-piece';
                piece.style.left = Math.random() * 100 + '%';
                piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                piece.style.animationDelay = Math.random() * 2 + 's';
                piece.style.animationDuration = (3 + Math.random() * 2) + 's';
                if (Math.random() > 0.5) piece.style.borderRadius = '50%';
                container.appendChild(piece);
            }
        }

        function switchState(state) {
            document.querySelectorAll('.state').forEach(s => s.classList.remove('active'));
            document.getElementById(state + 'State').classList.add('active');

            const mainBox = document.getElementById('mainBox');
            const light1 = document.getElementById('light1');
            const light2 = document.getElementById('light2');

            mainBox.classList.remove('success', 'error');
            light1.classList.remove('success', 'error');
            light2.classList.remove('success', 'error');

            if (state === 'success') {
                mainBox.classList.add('success');
                light1.classList.add('success');
                light2.classList.add('success');
                createConfetti();
            } else if (state === 'error') {
                mainBox.classList.add('error');
                light1.classList.add('error');
                light2.classList.add('error');
            }
        }

        function showStatus(msg, type) {
            const el = document.getElementById('statusMsg');
            el.className = 'status-msg show ' + type;
            if (type === 'loading') {
                el.innerHTML = '<span class="loading-spinner"></span> ' + msg;
            } else {
                el.textContent = msg;
            }
        }

        function hideStatus() {
            document.getElementById('statusMsg').className = 'status-msg';
        }

        async function loadFeatureConfig() {
            featureId = getFeatureIdFromURL();
            
            if (!featureId) {
                showErrorState("Feature Not Found", "This feature doesn't exist or the link is invalid.");
                return;
            }

            try {
                const res = await fetch('/api/feature-config/' + featureId);
                if (!res.ok) {
                    showErrorState("Feature Not Found", "This feature doesn't exist or the link is invalid.");
                    return;
                }
                
                featureConfig = await res.json();
                displayFeature();
            } catch (e) {
                showErrorState("Connection Error", "Failed to load feature configuration.");
            }
        }

        function displayFeature() {
            document.getElementById('pageTitle').textContent = 'Unlock ' + featureConfig.name + ' - Vadrifts';
            document.getElementById('featureIcon').textContent = featureConfig.icon;
            document.getElementById('featureTitle').textContent = 'Unlock ' + featureConfig.name;
            document.getElementById('featureDescription').textContent = featureConfig.description;
            document.getElementById('unlockBtnText').textContent = 'Unlock +' + featureConfig.credits_per_unlock + ' Credits';
            document.getElementById('creditsPerUnlock').textContent = '+' + featureConfig.credits_per_unlock + ' credits per unlock';

            switchState('unlock');
            if (window.lucide) lucide.createIcons();
        }

        function showSuccessState() {
            if (successData.icon && !successData.icon.includes('{{')) {
                document.getElementById('successIcon').textContent = successData.icon;
            }
            if (successData.creditsAdded && !successData.creditsAdded.includes('{{')) {
                document.getElementById('creditsEarnedText').textContent = '+' + successData.creditsAdded + ' credits';
            }
            if (successData.totalCredits && !successData.totalCredits.includes('{{')) {
                document.getElementById('totalCredits').textContent = successData.totalCredits;
            }
            if (successData.name && !successData.name.includes('{{')) {
                document.getElementById('pageTitle').textContent = successData.name + ' Unlocked! - Vadrifts';
            }

            switchState('success');
        }

        function showErrorState(title, message) {
            if (title) document.getElementById('errorTitle').textContent = title;
            if (message) document.getElementById('errorMessage').textContent = message;
            
            switchState('error');
        }

        async function startUnlock() {
            if (!featureConfig) return;

            const btn = document.getElementById('unlockBtn');
            btn.disabled = true;
            showStatus('Starting verification...', 'loading');

            try {
                const res = await fetch('/start-unlock/' + featureId);
                const data = await res.json();

                if (data.success) {
                    showStatus('Redirecting...', 'loading');
                    setTimeout(() => {
                        window.location.href = featureConfig.workink_url;
                    }, 800);
                } else {
                    showStatus('Failed to start. Please try again.', 'error');
                    btn.disabled = false;
                }
            } catch (e) {
                showStatus('Network error. Please try again.', 'error');
                btn.disabled = false;
            }
        }

        function init() {
            createParticles();
            
            if (pageMode === 'success') {
                showSuccessState();
            } else if (pageMode === 'error') {
                showErrorState(
                    errorData.title.includes('{{') ? null : errorData.title,
                    errorData.message.includes('{{') ? null : errorData.message
                );
            } else {
                loadFeatureConfig();
            }

            if (window.lucide) lucide.createIcons();
        }

        window.addEventListener('load', init);
    </script>
</body>
</html>
